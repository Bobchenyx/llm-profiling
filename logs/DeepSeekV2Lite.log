Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.64s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:03<00:03,  1.70s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:05<00:01,  1.88s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:06<00:00,  1.66s/it]

-------------------------- DeepSpeed Flops Profiler --------------------------
Profile Summary at step 1:
Notations:
data parallel size (dp_size), model parallel size(mp_size),
number of parameters (params), number of multiply-accumulate operations(MACs),
number of floating-point operations (flops), floating-point operations per second (FLOPS),
fwd latency (forward propagation latency), bwd latency (backward propagation latency),
step (weights update latency), iter latency (sum of fwd, bwd and step latency)

params per GPU:                                                         15.71 B 
params of model = params per GPU * mp_size:                             0       
fwd MACs per GPU:                                                       1.26 TMACs
fwd flops per GPU:                                                      2.56 T  
fwd flops of model = fwd flops per GPU * mp_size:                       2.56 T  
fwd latency:                                                            123.37 ms
fwd FLOPS per GPU = fwd flops per GPU / fwd latency:                    20.75 TFLOPS

----------------------------- Aggregated Profile per GPU -----------------------------
Top 1 modules in terms of params, MACs or fwd latency at different model depths:
depth 0:
    params      - {'DeepseekV2ForCausalLM': '15.71 B'}
    MACs        - {'DeepseekV2ForCausalLM': '1.26 TMACs'}
    fwd latency - {'DeepseekV2ForCausalLM': '123.37 ms'}
depth 1:
    params      - {'DeepseekV2Model': '15.5 B'}
    MACs        - {'DeepseekV2Model': '1.16 TMACs'}
    fwd latency - {'DeepseekV2Model': '121.8 ms'}
depth 2:
    params      - {'ModuleList': '15.29 B'}
    MACs        - {'ModuleList': '1.16 TMACs'}
    fwd latency - {'ModuleList': '120.41 ms'}
depth 3:
    params      - {'DeepseekV2DecoderLayer': '15.29 B'}
    MACs        - {'DeepseekV2DecoderLayer': '1.16 TMACs'}
    fwd latency - {'DeepseekV2DecoderLayer': '120.41 ms'}
depth 4:
    params      - {'DeepseekV2MoE': '14.85 B'}
    MACs        - {'DeepseekV2MoE': '923.02 GMACs'}
    fwd latency - {'DeepseekV2MoE': '73.08 ms'}
depth 5:
    params      - {'ModuleList': '14.39 B'}
    MACs        - {'ModuleList': '690.95 GMACs'}
    fwd latency - {'ModuleList': '38.41 ms'}
depth 6:
    params      - {'DeepseekV2MLP': '14.39 B'}
    MACs        - {'DeepseekV2MLP': '690.95 GMACs'}
    fwd latency - {'DeepseekV2MLP': '38.41 ms'}

------------------------------ Detailed Profile per GPU ------------------------------
Each module profile is listed after its name in the following order: 
params, percentage of total params, MACs, percentage of total MACs, fwd latency, percentage of total fwd latency, fwd FLOPS

Note: 1. A module can have torch.nn.module or torch.nn.functional to compute logits (e.g. CrossEntropyLoss). They are not counted as submodules, thus not to be printed out. However they make up the difference between a parent's MACs (or latency) and the sum of its submodules'.
2. Number of floating-point operations is a theoretical estimation, thus FLOPS computed using that could be larger than the maximum system throughput.
3. The fwd latency listed in the top module's profile is directly captured at the module forward function in PyTorch, thus it's less than the fwd latency shown above which is captured in DeepSpeed.

DeepseekV2ForCausalLM(
  15.71 B = 100% Params, 1.26 TMACs = 100% MACs, 123.37 ms = 100% latency, 20.75 TFLOPS
  (model): DeepseekV2Model(
    15.5 B = 98.66% Params, 1.16 TMACs = 91.51% MACs, 121.8 ms = 98.73% latency, 19.25 TFLOPS
    (embed_tokens): Embedding(209.72 M = 1.34% Params, 0 MACs = 0% MACs, 155.21 us = 0.13% latency, 0 FLOPS, 102400, 2048)
    (layers): ModuleList(
      (0): DeepseekV2DecoderLayer(
        81.01 M = 0.52% Params, 41.81 GMACs = 3.31% MACs, 2.98 ms = 2.42% latency, 28.42 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 2.11 ms = 1.71% latency, 7.01 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 177.62 us = 0.14% latency, 36.27 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 82.49 us = 0.07% latency, 14.64 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 146.15 us = 0.12% latency, 231.39 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 67.47 us = 0.05% latency, 31.83 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 72.72 us = 0.06% latency, 59.06 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 43.87 us = 0.04% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MLP(
          67.24 M = 0.43% Params, 34.43 GMACs = 2.72% MACs, 417.23 us = 0.34% latency, 165.07 TFLOPS
          (gate_proj): Linear(22.41 M = 0.14% Params, 11.48 GMACs = 0.91% MACs, 88.21 us = 0.07% latency, 260.17 TFLOPS, in_features=2048, out_features=10944, bias=False)
          (up_proj): Linear(22.41 M = 0.14% Params, 11.48 GMACs = 0.91% MACs, 78.68 us = 0.06% latency, 291.71 TFLOPS, in_features=2048, out_features=10944, bias=False)
          (down_proj): Linear(22.41 M = 0.14% Params, 11.48 GMACs = 0.91% MACs, 81.54 us = 0.07% latency, 281.47 TFLOPS, in_features=10944, out_features=2048, bias=False)
          (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 68.66 us = 0.06% latency, 163.21 GFLOPS)
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 189.54 us = 0.15% latency, 2.84 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 132.56 us = 0.11% latency, 4.06 TFLOPS)
      )
      (1): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.27 ms = 3.46% latency, 20.36 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.28 ms = 1.04% latency, 11.56 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 59.13 us = 0.05% latency, 108.96 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 53.64 us = 0.04% latency, 22.52 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 125.17 us = 0.1% latency, 270.17 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 58.41 us = 0.05% latency, 36.76 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 60.08 us = 0.05% latency, 71.49 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 33.38 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.63 ms = 2.13% latency, 26.99 TFLOPS
          (experts): ModuleList(
            (0-21): 22 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (22): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 295.88 us = 0.24% latency, 29.95 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 69.38 us = 0.06% latency, 42.56 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 46.01 us = 0.04% latency, 64.17 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.72 us = 0.03% latency, 70.77 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 42.92 us = 0.03% latency, 33.6 GFLOPS)
            )
            (23-30): 8 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (31): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 241.28 us = 0.2% latency, 36.72 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.01 us = 0.03% latency, 72.01 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.34 us = 0.03% latency, 75.06 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 46.25 us = 0.04% latency, 63.84 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.62 us = 0.03% latency, 42.89 GFLOPS)
            )
            (32-42): 11 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (43): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 242.23 us = 0.2% latency, 36.58 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.96 us = 0.03% latency, 70.37 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.05 us = 0.03% latency, 73.72 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 47.45 us = 0.04% latency, 62.24 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.14 us = 0.03% latency, 43.51 GFLOPS)
            )
            (44): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 222.21 us = 0.18% latency, 39.88 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.62 us = 0.03% latency, 76.45 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.95 us = 0.03% latency, 79.9 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.95 us = 0.03% latency, 45.13 GFLOPS)
            )
            (45): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 221.97 us = 0.18% latency, 39.92 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.58 us = 0.03% latency, 74.61 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.48 us = 0.03% latency, 80.95 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.52 us = 0.02% latency, 47.24 GFLOPS)
            )
            (46): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (47): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 243.19 us = 0.2% latency, 36.44 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 49.11 us = 0.04% latency, 60.12 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 36.95 us = 0.03% latency, 39.01 GFLOPS)
            )
            (48-63): 16 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 225.78 us = 0.18% latency, 594.47 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 298.02 us = 0.24% latency, 59.46 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 65.33 us = 0.05% latency, 90.4 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 51.98 us = 0.04% latency, 113.62 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 55.07 us = 0.04% latency, 107.23 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 38.15 us = 0.03% latency, 75.59 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 122.79 us = 0.1% latency, 4.38 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 122.79 us = 0.1% latency, 4.38 TFLOPS)
      )
      (2): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.09 ms = 3.31% latency, 21.26 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.3 ms = 1.06% latency, 11.37 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 62.47 us = 0.05% latency, 103.14 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 56.03 us = 0.05% latency, 21.56 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 134.47 us = 0.11% latency, 251.49 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 60.08 us = 0.05% latency, 35.74 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 69.86 us = 0.06% latency, 61.48 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 33.38 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.41 ms = 1.96% latency, 29.42 TFLOPS
          (experts): ModuleList(
            (0-2): 3 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (3): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 282.76 us = 0.23% latency, 31.34 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 60.08 us = 0.05% latency, 49.15 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 45.06 us = 0.04% latency, 65.53 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.72 us = 0.03% latency, 70.77 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 45.3 us = 0.04% latency, 31.83 GFLOPS)
            )
            (4-6): 3 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (7): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 257.25 us = 0.21% latency, 34.44 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.48 us = 0.03% latency, 71.18 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 45.06 us = 0.04% latency, 65.53 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.29 us = 0.03% latency, 73.28 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 47.68 us = 0.04% latency, 30.24 GFLOPS)
            )
            (8-12): 5 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (13): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 227.21 us = 0.18% latency, 39 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.34 us = 0.03% latency, 75.06 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.95 us = 0.03% latency, 79.9 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.66 us = 0.03% latency, 44.14 GFLOPS)
            )
            (14-21): 8 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (22): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 224.35 us = 0.18% latency, 39.49 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.9 us = 0.03% latency, 43.82 GFLOPS)
            )
            (23-32): 10 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (33): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 221.01 us = 0.18% latency, 40.09 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.24 us = 0.03% latency, 81.48 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.71 us = 0.03% latency, 45.47 GFLOPS)
            )
            (34-38): 5 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (39): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 239.13 us = 0.19% latency, 37.05 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.95 us = 0.03% latency, 79.9 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.72 us = 0.03% latency, 70.77 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 41.72 us = 0.03% latency, 34.56 GFLOPS)
            )
            (40-63): 24 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 140.43 us = 0.11% latency, 955.79 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 304.94 us = 0.25% latency, 58.11 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 65.57 us = 0.05% latency, 90.07 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 53.64 us = 0.04% latency, 110.09 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 49.11 us = 0.04% latency, 120.24 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 47.68 us = 0.04% latency, 60.47 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 131.61 us = 0.11% latency, 4.09 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 126.36 us = 0.1% latency, 4.26 TFLOPS)
      )
      (3): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.12 ms = 3.34% latency, 21.08 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.34 ms = 1.09% latency, 11.02 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 61.04 us = 0.05% latency, 105.55 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 91.55 us = 0.07% latency, 13.19 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 130.41 us = 0.11% latency, 259.3 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 60.08 us = 0.05% latency, 35.74 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 62.7 us = 0.05% latency, 68.5 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 34.81 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.42 ms = 1.96% latency, 29.32 TFLOPS
          (experts): ModuleList(
            (0-1): 2 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (2): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 289.44 us = 0.23% latency, 30.61 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 61.51 us = 0.05% latency, 48 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.11 us = 0.04% latency, 66.95 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 55.55 us = 0.05% latency, 53.15 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 37.67 us = 0.03% latency, 38.27 GFLOPS)
            )
            (3): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (4): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 247 us = 0.2% latency, 35.87 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 45.06 us = 0.04% latency, 65.53 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 45.78 us = 0.04% latency, 64.5 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.62 us = 0.03% latency, 42.89 GFLOPS)
            )
            (5-18): 14 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (19): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 226.02 us = 0.18% latency, 39.2 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.19 us = 0.03% latency, 44.79 GFLOPS)
            )
            (20-24): 5 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (25): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 227.93 us = 0.18% latency, 38.87 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.58 us = 0.03% latency, 74.61 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.95 us = 0.03% latency, 45.13 GFLOPS)
            )
            (26-48): 23 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (49): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 247.24 us = 0.2% latency, 35.84 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.62 us = 0.03% latency, 76.45 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.53 us = 0.03% latency, 72.85 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.96 us = 0.03% latency, 70.37 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 39.58 us = 0.03% latency, 36.43 GFLOPS)
            )
            (50-53): 4 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (54): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 222.44 us = 0.18% latency, 39.83 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.23 us = 0.03% latency, 46.16 GFLOPS)
            )
            (55-63): 9 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 144.24 us = 0.12% latency, 930.52 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 297.55 us = 0.24% latency, 59.56 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 64.37 us = 0.05% latency, 91.74 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 52.45 us = 0.04% latency, 112.59 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 54.6 us = 0.04% latency, 108.17 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 37.67 us = 0.03% latency, 76.55 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 122.79 us = 0.1% latency, 4.38 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 123.98 us = 0.1% latency, 4.34 TFLOPS)
      )
      (4): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.04 ms = 3.28% latency, 21.51 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.29 ms = 1.05% latency, 11.46 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 63.18 us = 0.05% latency, 101.97 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 55.07 us = 0.04% latency, 21.93 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 129.46 us = 0.1% latency, 261.21 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 59.84 us = 0.05% latency, 35.89 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 62.47 us = 0.05% latency, 68.76 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 34.33 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.39 ms = 1.94% latency, 29.75 TFLOPS
          (experts): ModuleList(
            (0-10): 11 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (11): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 283.48 us = 0.23% latency, 31.26 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 59.13 us = 0.05% latency, 49.94 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 49.59 us = 0.04% latency, 59.54 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.58 us = 0.04% latency, 66.23 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 37.91 us = 0.03% latency, 38.03 GFLOPS)
            )
            (12-13): 2 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (14): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 234.84 us = 0.19% latency, 37.73 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.01 us = 0.03% latency, 72.01 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.62 us = 0.03% latency, 42.89 GFLOPS)
            )
            (15-20): 6 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (21): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 239.37 us = 0.19% latency, 37.02 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 45.78 us = 0.04% latency, 64.5 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.53 us = 0.03% latency, 72.85 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 34.33 us = 0.03% latency, 42 GFLOPS)
            )
            (22-30): 9 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (31): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 221.73 us = 0.18% latency, 39.96 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.95 us = 0.03% latency, 79.9 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.23 us = 0.03% latency, 46.16 GFLOPS)
            )
            (32): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (33): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 239.61 us = 0.19% latency, 36.98 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 42.68 us = 0.03% latency, 69.19 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 42.92 us = 0.03% latency, 68.8 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.95 us = 0.03% latency, 45.13 GFLOPS)
            )
            (34-48): 15 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (49): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 220.78 us = 0.18% latency, 40.13 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.76 us = 0.02% latency, 46.88 GFLOPS)
            )
            (50-63): 14 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 139.24 us = 0.11% latency, 963.98 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 293.25 us = 0.24% latency, 60.43 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 63.18 us = 0.05% latency, 93.47 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 52.21 us = 0.04% latency, 113.1 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 50.31 us = 0.04% latency, 117.39 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 38.15 us = 0.03% latency, 75.59 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 124.45 us = 0.1% latency, 4.32 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 125.65 us = 0.1% latency, 4.28 TFLOPS)
      )
      (5): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.27 ms = 3.46% latency, 20.38 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.28 ms = 1.04% latency, 11.56 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 63.9 us = 0.05% latency, 100.83 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 53.41 us = 0.04% latency, 22.62 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 125.65 us = 0.1% latency, 269.14 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 59.6 us = 0.05% latency, 36.03 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 61.04 us = 0.05% latency, 70.37 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 33.86 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.62 ms = 2.12% latency, 27.12 TFLOPS
          (experts): ModuleList(
            (0-18): 19 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (19): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 282.53 us = 0.23% latency, 31.36 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 57.94 us = 0.05% latency, 50.97 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 46.73 us = 0.04% latency, 63.19 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.77 us = 0.03% latency, 72.43 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 38.39 us = 0.03% latency, 37.56 GFLOPS)
            )
            (20): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 233.17 us = 0.19% latency, 38 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.05 us = 0.03% latency, 73.72 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.05 us = 0.03% latency, 73.72 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 34.09 us = 0.03% latency, 42.29 GFLOPS)
            )
            (21-46): 26 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (47): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 238.42 us = 0.19% latency, 37.16 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.34 us = 0.03% latency, 75.06 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 45.06 us = 0.04% latency, 65.53 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.95 us = 0.03% latency, 45.13 GFLOPS)
            )
            (48): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (49): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 231.27 us = 0.19% latency, 38.31 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.01 us = 0.03% latency, 72.01 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.86 us = 0.03% latency, 42.59 GFLOPS)
            )
            (50-51): 2 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (52): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 247.96 us = 0.2% latency, 35.73 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 55.55 us = 0.05% latency, 53.15 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.29 us = 0.03% latency, 73.28 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 34.33 us = 0.03% latency, 42 GFLOPS)
            )
            (53): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (54): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 222.92 us = 0.18% latency, 39.75 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.48 us = 0.03% latency, 80.95 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.99 us = 0.03% latency, 46.52 GFLOPS)
            )
            (55-63): 9 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 138.52 us = 0.11% latency, 968.95 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 332.59 us = 0.27% latency, 53.28 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 70.57 us = 0.06% latency, 83.68 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 59.13 us = 0.05% latency, 99.88 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 57.22 us = 0.05% latency, 103.21 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 41.72 us = 0.03% latency, 69.11 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 130.65 us = 0.11% latency, 4.12 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 123.5 us = 0.1% latency, 4.36 TFLOPS)
      )
      (6): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.4 ms = 3.56% latency, 19.76 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.27 ms = 1.03% latency, 11.62 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 60.08 us = 0.05% latency, 107.23 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 55.07 us = 0.04% latency, 21.93 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 124.93 us = 0.1% latency, 270.69 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 59.13 us = 0.05% latency, 36.32 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 60.8 us = 0.05% latency, 70.64 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 34.33 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.76 ms = 2.24% latency, 25.71 TFLOPS
          (experts): ModuleList(
            (0-12): 13 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (13): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 286.58 us = 0.23% latency, 30.92 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 59.37 us = 0.05% latency, 49.74 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 46.73 us = 0.04% latency, 63.19 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.25 us = 0.03% latency, 71.59 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 47.45 us = 0.04% latency, 30.39 GFLOPS)
            )
            (14-20): 7 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (21): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 240.56 us = 0.19% latency, 36.83 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.25 us = 0.03% latency, 71.59 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.25 us = 0.03% latency, 71.59 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 35.29 us = 0.03% latency, 40.86 GFLOPS)
            )
            (22): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 228.64 us = 0.19% latency, 38.75 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.34 us = 0.03% latency, 75.06 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.66 us = 0.03% latency, 44.14 GFLOPS)
            )
            (23-31): 9 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (32): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 252.25 us = 0.2% latency, 35.13 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.58 us = 0.04% latency, 66.23 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.29 us = 0.03% latency, 73.28 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.19 us = 0.03% latency, 44.79 GFLOPS)
            )
            (33-41): 9 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (42): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 234.13 us = 0.19% latency, 37.84 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.01 us = 0.03% latency, 72.01 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 37.67 us = 0.03% latency, 38.27 GFLOPS)
            )
            (43-46): 4 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (47): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 220.3 us = 0.18% latency, 40.22 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.95 us = 0.03% latency, 79.9 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.99 us = 0.03% latency, 46.52 GFLOPS)
            )
            (48-63): 16 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 139.47 us = 0.11% latency, 962.33 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 315.19 us = 0.26% latency, 56.22 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 71.53 us = 0.06% latency, 82.57 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 53.17 us = 0.04% latency, 111.08 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 51.98 us = 0.04% latency, 113.62 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 41.72 us = 0.03% latency, 69.11 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 124.93 us = 0.1% latency, 4.31 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 122.07 us = 0.1% latency, 4.41 TFLOPS)
      )
      (7): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.43 ms = 3.59% latency, 19.61 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.28 ms = 1.04% latency, 11.53 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 62.23 us = 0.05% latency, 103.53 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 54.36 us = 0.04% latency, 22.22 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 141.14 us = 0.11% latency, 239.59 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 59.37 us = 0.05% latency, 36.17 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 66.04 us = 0.05% latency, 65.03 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 33.86 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.77 ms = 2.25% latency, 25.6 TFLOPS
          (experts): ModuleList(
            (0-17): 18 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (18): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 270.13 us = 0.22% latency, 32.8 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 57.7 us = 0.05% latency, 51.18 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 43.15 us = 0.03% latency, 68.42 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.77 us = 0.03% latency, 72.43 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 38.15 us = 0.03% latency, 37.8 GFLOPS)
            )
            (19-27): 9 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (28): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 250.82 us = 0.2% latency, 35.33 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.34 us = 0.03% latency, 75.06 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 47.92 us = 0.04% latency, 61.62 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 47.45 us = 0.04% latency, 62.24 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.86 us = 0.03% latency, 42.59 GFLOPS)
            )
            (29-42): 14 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (43): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 231.27 us = 0.19% latency, 38.31 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.01 us = 0.03% latency, 72.01 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.66 us = 0.03% latency, 44.14 GFLOPS)
            )
            (44): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 228.17 us = 0.18% latency, 38.83 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.34 us = 0.03% latency, 75.06 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.47 us = 0.03% latency, 45.81 GFLOPS)
            )
            (45-57): 13 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (58): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 234.84 us = 0.19% latency, 37.73 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.58 us = 0.03% latency, 74.61 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.53 us = 0.03% latency, 72.85 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 37.91 us = 0.03% latency, 38.03 GFLOPS)
            )
            (59-61): 3 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (62): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 235.08 us = 0.19% latency, 37.69 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.77 us = 0.03% latency, 72.43 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 36.95 us = 0.03% latency, 39.01 GFLOPS)
            )
            (63): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 138.52 us = 0.11% latency, 968.95 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 318.77 us = 0.26% latency, 55.59 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 72.48 us = 0.06% latency, 81.48 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 52.93 us = 0.04% latency, 111.58 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 51.74 us = 0.04% latency, 114.15 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 43.15 us = 0.03% latency, 66.82 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 124.45 us = 0.1% latency, 4.32 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 123.5 us = 0.1% latency, 4.36 TFLOPS)
      )
      (8): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.42 ms = 3.58% latency, 19.66 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.28 ms = 1.04% latency, 11.55 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 60.8 us = 0.05% latency, 105.97 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 55.79 us = 0.05% latency, 21.65 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 127.79 us = 0.1% latency, 264.63 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 60.56 us = 0.05% latency, 35.46 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 59.84 us = 0.05% latency, 71.77 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 35.05 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.78 ms = 2.25% latency, 25.56 TFLOPS
          (experts): ModuleList(
            (0-1): 2 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (2): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 282.29 us = 0.23% latency, 31.39 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 58.89 us = 0.05% latency, 50.14 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 46.01 us = 0.04% latency, 64.17 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.72 us = 0.03% latency, 70.77 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 43.63 us = 0.04% latency, 33.05 GFLOPS)
            )
            (3-10): 8 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (11): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 236.75 us = 0.19% latency, 37.43 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.25 us = 0.03% latency, 71.59 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.53 us = 0.03% latency, 72.85 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 34.33 us = 0.03% latency, 42 GFLOPS)
            )
            (12-29): 18 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (30): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 225.31 us = 0.18% latency, 39.33 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.19 us = 0.03% latency, 44.79 GFLOPS)
            )
            (31-38): 8 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (39): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 235.08 us = 0.19% latency, 37.69 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.05 us = 0.03% latency, 73.72 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.72 us = 0.03% latency, 80.42 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.01 us = 0.03% latency, 72.01 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.95 us = 0.03% latency, 45.13 GFLOPS)
            )
            (40-46): 7 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (47): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 223.4 us = 0.18% latency, 39.66 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.66 us = 0.03% latency, 44.14 GFLOPS)
            )
            (48-53): 6 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (54): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 237.94 us = 0.19% latency, 37.24 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 46.01 us = 0.04% latency, 64.17 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.25 us = 0.03% latency, 71.59 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.38 us = 0.03% latency, 43.2 GFLOPS)
            )
            (55-63): 9 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 138.04 us = 0.11% latency, 972.3 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 321.39 us = 0.26% latency, 55.14 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 73.19 us = 0.06% latency, 80.68 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 54.12 us = 0.04% latency, 109.12 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 51.98 us = 0.04% latency, 113.62 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 43.39 us = 0.04% latency, 66.45 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 126.6 us = 0.1% latency, 4.25 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 122.07 us = 0.1% latency, 4.41 TFLOPS)
      )
      (9): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.41 ms = 3.57% latency, 19.7 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.28 ms = 1.04% latency, 11.55 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 61.99 us = 0.05% latency, 103.93 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 53.88 us = 0.04% latency, 22.42 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 127.55 us = 0.1% latency, 265.12 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 75.82 us = 0.06% latency, 28.32 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 61.75 us = 0.05% latency, 69.55 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 33.62 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.75 ms = 2.23% latency, 25.79 TFLOPS
          (experts): ModuleList(
            (0-11): 12 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (12): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 271.08 us = 0.22% latency, 32.69 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 58.89 us = 0.05% latency, 50.14 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 42.92 us = 0.03% latency, 68.8 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.25 us = 0.03% latency, 71.59 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 37.67 us = 0.03% latency, 38.27 GFLOPS)
            )
            (13): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 237.7 us = 0.19% latency, 37.28 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.01 us = 0.03% latency, 72.01 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.72 us = 0.03% latency, 70.77 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.38 us = 0.03% latency, 43.2 GFLOPS)
            )
            (14-21): 8 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (22): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 230.31 us = 0.19% latency, 38.47 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.96 us = 0.03% latency, 70.37 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.62 us = 0.03% latency, 76.45 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.72 us = 0.03% latency, 80.42 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 34.09 us = 0.03% latency, 42.29 GFLOPS)
            )
            (23-26): 4 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (27): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 224.35 us = 0.18% latency, 39.49 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.99 us = 0.03% latency, 46.52 GFLOPS)
            )
            (28-30): 3 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (31): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 225.07 us = 0.18% latency, 39.37 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.62 us = 0.03% latency, 76.45 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.95 us = 0.03% latency, 45.13 GFLOPS)
            )
            (32-43): 12 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (44): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 228.88 us = 0.19% latency, 38.71 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.58 us = 0.03% latency, 74.61 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.99 us = 0.03% latency, 46.52 GFLOPS)
            )
            (45-63): 19 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 138.52 us = 0.11% latency, 968.95 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 329.97 us = 0.27% latency, 53.7 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 70.33 us = 0.06% latency, 83.97 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 63.66 us = 0.05% latency, 92.77 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 51.98 us = 0.04% latency, 113.62 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 44.35 us = 0.04% latency, 65.02 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 128.03 us = 0.1% latency, 4.2 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 134.47 us = 0.11% latency, 4 TFLOPS)
      )
      (10): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.44 ms = 3.6% latency, 19.56 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.28 ms = 1.04% latency, 11.59 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 61.51 us = 0.05% latency, 104.73 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 55.07 us = 0.04% latency, 21.93 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 127.79 us = 0.1% latency, 264.63 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 59.6 us = 0.05% latency, 36.03 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 61.75 us = 0.05% latency, 69.55 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 33.38 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.8 ms = 2.27% latency, 25.39 TFLOPS
          (experts): ModuleList(
            (0-1): 2 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (2): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 296.59 us = 0.24% latency, 29.87 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 58.89 us = 0.05% latency, 50.14 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 48.88 us = 0.04% latency, 60.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.25 us = 0.03% latency, 71.59 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 51.02 us = 0.04% latency, 28.26 GFLOPS)
            )
            (3-8): 6 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (9): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 233.41 us = 0.19% latency, 37.96 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.58 us = 0.03% latency, 74.61 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.05 us = 0.03% latency, 73.72 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 34.57 us = 0.03% latency, 41.71 GFLOPS)
            )
            (10-12): 3 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (13): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 228.4 us = 0.19% latency, 38.79 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.42 us = 0.03% latency, 44.47 GFLOPS)
            )
            (14-30): 17 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (31): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 223.4 us = 0.18% latency, 39.66 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.95 us = 0.03% latency, 45.13 GFLOPS)
            )
            (32-41): 10 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (42): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 233.65 us = 0.19% latency, 37.92 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.11 us = 0.04% latency, 66.95 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.77 us = 0.03% latency, 72.43 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.95 us = 0.03% latency, 45.13 GFLOPS)
            )
            (43-46): 4 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (47): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 222.44 us = 0.18% latency, 39.83 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.62 us = 0.03% latency, 76.45 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.99 us = 0.03% latency, 46.52 GFLOPS)
            )
            (48-63): 16 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 135.9 us = 0.11% latency, 987.65 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 338.55 us = 0.27% latency, 52.34 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 81.06 us = 0.07% latency, 72.85 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 55.31 us = 0.04% latency, 106.77 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 61.04 us = 0.05% latency, 96.76 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 43.87 us = 0.04% latency, 65.73 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 134.23 us = 0.11% latency, 4.01 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 122.07 us = 0.1% latency, 4.41 TFLOPS)
      )
      (11): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.57 ms = 3.71% latency, 19 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.36 ms = 1.1% latency, 10.89 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 61.75 us = 0.05% latency, 104.33 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 61.27 us = 0.05% latency, 19.71 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 135.42 us = 0.11% latency, 249.72 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 64.61 us = 0.05% latency, 33.24 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 65.33 us = 0.05% latency, 65.75 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 34.81 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.83 ms = 2.3% latency, 25.05 TFLOPS
          (experts): ModuleList(
            (0-9): 10 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (10): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 289.68 us = 0.23% latency, 30.59 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 60.08 us = 0.05% latency, 49.15 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 46.01 us = 0.04% latency, 64.17 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.48 us = 0.03% latency, 71.18 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 48.16 us = 0.04% latency, 29.94 GFLOPS)
            )
            (11): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 253.44 us = 0.21% latency, 34.96 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.25 us = 0.03% latency, 71.59 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 46.73 us = 0.04% latency, 63.19 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 34.81 us = 0.03% latency, 41.42 GFLOPS)
            )
            (12-16): 5 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (17): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 233.89 us = 0.19% latency, 37.88 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.25 us = 0.03% latency, 71.59 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.77 us = 0.03% latency, 72.43 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.38 us = 0.03% latency, 43.2 GFLOPS)
            )
            (18): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 226.5 us = 0.18% latency, 39.12 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.14 us = 0.03% latency, 43.51 GFLOPS)
            )
            (19-26): 8 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (27): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 230.55 us = 0.19% latency, 38.43 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36 us = 0.03% latency, 82.02 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 39.34 us = 0.03% latency, 36.65 GFLOPS)
            )
            (28-53): 26 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (54): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 237.23 us = 0.19% latency, 37.35 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 43.39 us = 0.04% latency, 68.05 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 47.92 us = 0.04% latency, 61.62 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.28 us = 0.02% latency, 47.62 GFLOPS)
            )
            (55-63): 9 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 149.97 us = 0.12% latency, 895.01 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 331.4 us = 0.27% latency, 53.47 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 77.49 us = 0.06% latency, 76.21 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 55.07 us = 0.04% latency, 107.23 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 58.17 us = 0.05% latency, 101.52 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 43.39 us = 0.04% latency, 66.45 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 131.37 us = 0.11% latency, 4.09 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 136.14 us = 0.11% latency, 3.95 TFLOPS)
      )
      (12): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.54 ms = 3.68% latency, 19.15 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.35 ms = 1.1% latency, 10.93 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 61.99 us = 0.05% latency, 103.93 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 59.84 us = 0.05% latency, 20.19 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 136.38 us = 0.11% latency, 247.97 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 64.13 us = 0.05% latency, 33.48 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 65.57 us = 0.05% latency, 65.51 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 34.81 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.8 ms = 2.27% latency, 25.41 TFLOPS
          (experts): ModuleList(
            (0-2): 3 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (3): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 274.18 us = 0.22% latency, 32.32 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 60.32 us = 0.05% latency, 48.95 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.11 us = 0.04% latency, 66.95 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.25 us = 0.03% latency, 71.59 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 37.43 us = 0.03% latency, 38.52 GFLOPS)
            )
            (4): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 241.76 us = 0.2% latency, 36.65 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.34 us = 0.03% latency, 75.06 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.05 us = 0.03% latency, 73.72 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 47.68 us = 0.04% latency, 61.92 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 35.05 us = 0.03% latency, 41.14 GFLOPS)
            )
            (5-29): 25 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (30): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 228.17 us = 0.18% latency, 38.83 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.96 us = 0.03% latency, 70.37 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.9 us = 0.03% latency, 43.82 GFLOPS)
            )
            (31-36): 6 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (37): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 238.42 us = 0.19% latency, 37.16 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 49.35 us = 0.04% latency, 59.83 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.53 us = 0.03% latency, 72.85 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.19 us = 0.03% latency, 44.79 GFLOPS)
            )
            (38-49): 12 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (50): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 219.82 us = 0.18% latency, 40.31 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.24 us = 0.03% latency, 81.48 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.95 us = 0.03% latency, 45.13 GFLOPS)
            )
            (51-58): 8 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (59): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 217.91 us = 0.18% latency, 40.66 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.72 us = 0.03% latency, 80.42 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.28 us = 0.02% latency, 47.62 GFLOPS)
            )
            (60-63): 4 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 149.01 us = 0.12% latency, 900.74 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 329.97 us = 0.27% latency, 53.7 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 76.77 us = 0.06% latency, 76.92 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 61.27 us = 0.05% latency, 96.38 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 51.5 us = 0.04% latency, 114.67 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 42.2 us = 0.03% latency, 68.33 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 148.53 us = 0.12% latency, 3.62 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 121.59 us = 0.1% latency, 4.42 TFLOPS)
      )
      (13): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.53 ms = 3.67% latency, 19.19 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.38 ms = 1.12% latency, 10.73 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 67.71 us = 0.05% latency, 95.15 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 59.37 us = 0.05% latency, 20.35 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 145.44 us = 0.12% latency, 232.52 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 67 us = 0.05% latency, 32.05 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 80.35 us = 0.07% latency, 53.46 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 37.67 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.78 ms = 2.26% latency, 25.52 TFLOPS
          (experts): ModuleList(
            (0-10): 11 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (11): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 278.23 us = 0.23% latency, 31.85 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 65.09 us = 0.05% latency, 45.37 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 43.87 us = 0.04% latency, 67.31 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.29 us = 0.03% latency, 73.28 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 38.39 us = 0.03% latency, 37.56 GFLOPS)
            )
            (12-23): 12 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (24): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 247.48 us = 0.2% latency, 35.8 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.58 us = 0.03% latency, 74.61 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 43.39 us = 0.04% latency, 68.05 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.58 us = 0.03% latency, 74.61 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.9 us = 0.03% latency, 43.82 GFLOPS)
            )
            (25-33): 9 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (34): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 228.4 us = 0.19% latency, 38.79 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.34 us = 0.03% latency, 75.06 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.9 us = 0.03% latency, 43.82 GFLOPS)
            )
            (35): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (36): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 228.17 us = 0.18% latency, 38.83 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.72 us = 0.03% latency, 80.42 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.11 us = 0.04% latency, 66.95 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.71 us = 0.03% latency, 45.47 GFLOPS)
            )
            (37-46): 10 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (47): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 220.06 us = 0.18% latency, 40.26 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.62 us = 0.03% latency, 76.45 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.72 us = 0.03% latency, 80.42 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.23 us = 0.03% latency, 46.16 GFLOPS)
            )
            (48-57): 10 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (58): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 232.7 us = 0.19% latency, 38.08 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.24 us = 0.03% latency, 81.48 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.72 us = 0.03% latency, 70.77 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 37.91 us = 0.03% latency, 38.03 GFLOPS)
            )
            (59-63): 5 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 151.87 us = 0.12% latency, 883.77 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 325.68 us = 0.26% latency, 54.41 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 76.77 us = 0.06% latency, 76.92 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 53.41 us = 0.04% latency, 110.58 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 56.74 us = 0.05% latency, 104.07 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 40.77 us = 0.03% latency, 70.73 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 125.17 us = 0.1% latency, 4.3 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 122.79 us = 0.1% latency, 4.38 TFLOPS)
      )
      (14): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.57 ms = 3.7% latency, 19.03 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.37 ms = 1.11% latency, 10.8 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 67.23 us = 0.05% latency, 95.82 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 61.27 us = 0.05% latency, 19.71 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 146.15 us = 0.12% latency, 231.39 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 68.19 us = 0.06% latency, 31.49 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 64.85 us = 0.05% latency, 66.23 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 34.81 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.83 ms = 2.29% latency, 25.13 TFLOPS
          (experts): ModuleList(
            (0-4): 5 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (5): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 291.59 us = 0.24% latency, 30.39 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 67.71 us = 0.05% latency, 43.61 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 48.4 us = 0.04% latency, 61.01 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 43.15 us = 0.03% latency, 68.42 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 38.62 us = 0.03% latency, 37.33 GFLOPS)
            )
            (6): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (7): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 233.41 us = 0.19% latency, 37.96 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.77 us = 0.03% latency, 72.43 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.34 us = 0.03% latency, 75.06 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.62 us = 0.03% latency, 76.45 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.38 us = 0.03% latency, 43.2 GFLOPS)
            )
            (8-22): 15 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (23): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 226.26 us = 0.18% latency, 39.16 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.34 us = 0.03% latency, 75.06 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.9 us = 0.03% latency, 43.82 GFLOPS)
            )
            (24-26): 3 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (27): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 237.23 us = 0.19% latency, 37.35 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 47.21 us = 0.04% latency, 62.55 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.05 us = 0.03% latency, 73.72 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.34 us = 0.03% latency, 75.06 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.66 us = 0.03% latency, 44.14 GFLOPS)
            )
            (28-47): 20 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (48): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 224.11 us = 0.18% latency, 39.54 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.95 us = 0.03% latency, 79.9 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.19 us = 0.03% latency, 44.79 GFLOPS)
            )
            (49-50): 2 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (51): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 229.84 us = 0.19% latency, 38.55 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 43.87 us = 0.04% latency, 67.31 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.71 us = 0.03% latency, 45.47 GFLOPS)
            )
            (52-63): 12 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 142.81 us = 0.12% latency, 939.84 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 325.92 us = 0.26% latency, 54.37 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 76.53 us = 0.06% latency, 77.16 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 53.64 us = 0.04% latency, 110.09 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 56.03 us = 0.05% latency, 105.4 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 42.2 us = 0.03% latency, 68.33 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 128.75 us = 0.1% latency, 4.18 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 127.32 us = 0.1% latency, 4.23 TFLOPS)
      )
      (15): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.92 ms = 3.98% latency, 17.68 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.37 ms = 1.11% latency, 10.78 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 61.04 us = 0.05% latency, 105.55 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 60.08 us = 0.05% latency, 20.11 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 136.85 us = 0.11% latency, 247.11 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 65.57 us = 0.05% latency, 32.75 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 66.76 us = 0.05% latency, 64.34 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 35.52 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 3.17 ms = 2.57% latency, 22.41 TFLOPS
          (experts): ModuleList(
            (0-4): 5 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (5): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 300.17 us = 0.24% latency, 29.52 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 58.65 us = 0.05% latency, 50.35 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.35 us = 0.04% latency, 66.59 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 44.82 us = 0.04% latency, 32.17 GFLOPS)
            )
            (6-13): 8 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (14): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 249.15 us = 0.2% latency, 35.56 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.58 us = 0.04% latency, 66.23 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 47.21 us = 0.04% latency, 62.55 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.01 us = 0.03% latency, 72.01 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 35.29 us = 0.03% latency, 40.86 GFLOPS)
            )
            (15-27): 13 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (28): DeepseekV2MLP(
              8.65 M = 0.06% Params, 69.21 MMACs = 0.01% MACs, 228.88 us = 0.19% latency, 604.88 GFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 23.07 MMACs = 0% MACs, 42.2 us = 0.03% latency, 1.09 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 23.07 MMACs = 0% MACs, 38.39 us = 0.03% latency, 1.2 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 23.07 MMACs = 0% MACs, 37.67 us = 0.03% latency, 1.22 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.95 us = 0.03% latency, 705.14 MFLOPS)
            )
            (29-35): 7 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (36): DeepseekV2MLP(
              8.65 M = 0.06% Params, 1.45 GMACs = 0.11% MACs, 225.78 us = 0.18% latency, 12.88 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 484.44 MMACs = 0.04% MACs, 40.53 us = 0.03% latency, 23.9 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 484.44 MMACs = 0.04% MACs, 38.62 us = 0.03% latency, 25.09 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 484.44 MMACs = 0.04% MACs, 37.91 us = 0.03% latency, 25.56 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.99 us = 0.03% latency, 15.26 GFLOPS)
            )
            (37): DeepseekV2MLP(
              8.65 M = 0.06% Params, 2.91 GMACs = 0.23% MACs, 237.23 us = 0.19% latency, 24.51 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 968.88 MMACs = 0.08% MACs, 39.1 us = 0.03% latency, 49.56 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 968.88 MMACs = 0.08% MACs, 37.91 us = 0.03% latency, 51.12 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 968.88 MMACs = 0.08% MACs, 42.92 us = 0.03% latency, 45.15 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.71 us = 0.03% latency, 29.84 GFLOPS)
            )
            (38-47): 10 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (48): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 225.78 us = 0.18% latency, 39.24 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 42.44 us = 0.03% latency, 69.58 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.23 us = 0.03% latency, 46.16 GFLOPS)
            )
            (49-51): 3 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (52): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 221.01 us = 0.18% latency, 40.09 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.62 us = 0.03% latency, 76.45 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 35.52 us = 0.03% latency, 83.12 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.76 us = 0.02% latency, 46.88 GFLOPS)
            )
            (53-54): 2 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (55): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 214.34 us = 0.17% latency, 41.34 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.24 us = 0.03% latency, 81.48 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.95 us = 0.03% latency, 79.9 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.48 us = 0.03% latency, 80.95 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.04 us = 0.02% latency, 47.99 GFLOPS)
            )
            (56-63): 8 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 146.39 us = 0.12% latency, 916.88 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 331.88 us = 0.27% latency, 53.4 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 76.77 us = 0.06% latency, 76.92 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 59.6 us = 0.05% latency, 99.08 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 57.22 us = 0.05% latency, 103.21 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 41.72 us = 0.03% latency, 69.11 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 130.41 us = 0.11% latency, 4.12 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 128.03 us = 0.1% latency, 4.2 TFLOPS)
      )
      (16): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.93 ms = 3.99% latency, 17.64 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.38 ms = 1.11% latency, 10.76 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 67 us = 0.05% latency, 96.16 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 61.27 us = 0.05% latency, 19.71 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 149.97 us = 0.12% latency, 225.5 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 66.04 us = 0.05% latency, 32.52 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 67 us = 0.05% latency, 64.11 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 37.43 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 3.18 ms = 2.58% latency, 22.31 TFLOPS
          (experts): ModuleList(
            (0-8): 9 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (9): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 269.89 us = 0.22% latency, 32.83 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 59.6 us = 0.05% latency, 49.54 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 42.68 us = 0.03% latency, 69.19 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.72 us = 0.03% latency, 70.77 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 37.19 us = 0.03% latency, 38.76 GFLOPS)
            )
            (10-12): 3 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (13): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 237.7 us = 0.19% latency, 37.28 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 45.06 us = 0.04% latency, 65.53 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.01 us = 0.03% latency, 72.01 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.38 us = 0.03% latency, 43.2 GFLOPS)
            )
            (14-25): 12 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (26): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 232.93 us = 0.19% latency, 38.04 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 45.3 us = 0.04% latency, 65.18 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.14 us = 0.03% latency, 43.51 GFLOPS)
            )
            (27-32): 6 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (33): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 225.78 us = 0.18% latency, 39.24 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.53 us = 0.03% latency, 72.85 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.47 us = 0.03% latency, 45.81 GFLOPS)
            )
            (34-36): 3 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (37): DeepseekV2MLP(
              8.65 M = 0.06% Params, 1.18 GMACs = 0.09% MACs, 227.69 us = 0.18% latency, 10.34 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 392.17 MMACs = 0.03% MACs, 40.53 us = 0.03% latency, 19.35 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 392.17 MMACs = 0.03% MACs, 38.15 us = 0.03% latency, 20.56 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 392.17 MMACs = 0.03% MACs, 38.39 us = 0.03% latency, 20.43 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.71 us = 0.03% latency, 12.08 GFLOPS)
            )
            (38-48): 11 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (49): DeepseekV2MLP(
              8.65 M = 0.06% Params, 3.25 GMACs = 0.26% MACs, 238.42 us = 0.19% latency, 27.29 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.08 GMACs = 0.09% MACs, 49.11 us = 0.04% latency, 44.15 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.08 GMACs = 0.09% MACs, 39.34 us = 0.03% latency, 55.12 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.08 GMACs = 0.09% MACs, 38.15 us = 0.03% latency, 56.84 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.14 us = 0.03% latency, 31.95 GFLOPS)
            )
            (50-62): 13 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (63): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 225.31 us = 0.18% latency, 39.33 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.23 us = 0.03% latency, 46.16 GFLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 149.25 us = 0.12% latency, 899.3 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 333.31 us = 0.27% latency, 53.17 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 77.01 us = 0.06% latency, 76.69 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 54.12 us = 0.04% latency, 109.12 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 57.22 us = 0.05% latency, 103.21 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 42.2 us = 0.03% latency, 68.33 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 132.08 us = 0.11% latency, 4.07 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 121.59 us = 0.1% latency, 4.42 TFLOPS)
      )
      (17): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.71 ms = 3.82% latency, 18.45 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.39 ms = 1.13% latency, 10.63 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 61.75 us = 0.05% latency, 104.33 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 63.18 us = 0.05% latency, 19.12 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 144.48 us = 0.12% latency, 234.06 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 65.09 us = 0.05% latency, 32.99 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 93.94 us = 0.08% latency, 45.72 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 34.57 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.94 ms = 2.38% latency, 24.15 TFLOPS
          (experts): ModuleList(
            (0): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 315.9 us = 0.26% latency, 28.05 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 67 us = 0.05% latency, 44.07 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.35 us = 0.04% latency, 66.59 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.53 us = 0.03% latency, 72.85 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 42.92 us = 0.03% latency, 33.6 GFLOPS)
            )
            (1-10): 10 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (11): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 239.13 us = 0.19% latency, 37.05 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 46.97 us = 0.04% latency, 62.87 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.53 us = 0.03% latency, 72.85 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.86 us = 0.03% latency, 42.59 GFLOPS)
            )
            (12-17): 6 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (18): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 223.16 us = 0.18% latency, 39.7 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.62 us = 0.03% latency, 76.45 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.47 us = 0.03% latency, 45.81 GFLOPS)
            )
            (19-23): 5 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (24): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 221.01 us = 0.18% latency, 40.09 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.71 us = 0.03% latency, 45.47 GFLOPS)
            )
            (25): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (26): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 216.48 us = 0.18% latency, 40.93 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.48 us = 0.03% latency, 80.95 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.48 us = 0.03% latency, 80.95 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36 us = 0.03% latency, 82.02 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.9 us = 0.03% latency, 43.82 GFLOPS)
            )
            (27-35): 9 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (36): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 234.13 us = 0.19% latency, 37.84 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 47.68 us = 0.04% latency, 61.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.9 us = 0.03% latency, 43.82 GFLOPS)
            )
            (37-63): 27 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 147.82 us = 0.12% latency, 908 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 341.89 us = 0.28% latency, 51.83 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 75.82 us = 0.06% latency, 77.89 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 68.19 us = 0.06% latency, 86.61 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 59.37 us = 0.05% latency, 99.48 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 41.25 us = 0.03% latency, 69.91 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 131.37 us = 0.11% latency, 4.09 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 128.03 us = 0.1% latency, 4.2 TFLOPS)
      )
      (18): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.66 ms = 3.77% latency, 18.66 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.35 ms = 1.1% latency, 10.95 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 60.56 us = 0.05% latency, 106.38 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 58.89 us = 0.05% latency, 20.51 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 134.71 us = 0.11% latency, 251.04 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 65.57 us = 0.05% latency, 32.75 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 69.38 us = 0.06% latency, 61.91 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 33.38 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.94 ms = 2.38% latency, 24.15 TFLOPS
          (experts): ModuleList(
            (0-1): 2 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (2): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 268.7 us = 0.22% latency, 32.98 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 58.41 us = 0.05% latency, 50.55 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 42.44 us = 0.03% latency, 69.58 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.53 us = 0.03% latency, 72.85 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 38.15 us = 0.03% latency, 37.8 GFLOPS)
            )
            (3-4): 2 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (5): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 235.8 us = 0.19% latency, 37.58 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.11 us = 0.04% latency, 66.95 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.34 us = 0.03% latency, 75.06 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.9 us = 0.03% latency, 43.82 GFLOPS)
            )
            (6-38): 33 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (39): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 242.71 us = 0.2% latency, 36.51 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 51.26 us = 0.04% latency, 57.6 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.53 us = 0.03% latency, 72.85 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.66 us = 0.03% latency, 44.14 GFLOPS)
            )
            (40-48): 9 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (49): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 231.74 us = 0.19% latency, 38.23 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.11 us = 0.04% latency, 66.95 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.9 us = 0.03% latency, 43.82 GFLOPS)
            )
            (50-55): 6 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (56): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 220.3 us = 0.18% latency, 40.22 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.34 us = 0.03% latency, 75.06 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.95 us = 0.03% latency, 79.9 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36 us = 0.03% latency, 82.02 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.47 us = 0.03% latency, 45.81 GFLOPS)
            )
            (57): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (58): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 222.21 us = 0.18% latency, 39.88 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.23 us = 0.03% latency, 46.16 GFLOPS)
            )
            (59-63): 5 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 157.12 us = 0.13% latency, 854.27 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 328.3 us = 0.27% latency, 53.98 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 76.29 us = 0.06% latency, 77.41 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 54.84 us = 0.04% latency, 107.69 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 56.51 us = 0.05% latency, 104.51 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 42.68 us = 0.03% latency, 67.57 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 129.46 us = 0.1% latency, 4.16 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 122.55 us = 0.1% latency, 4.39 TFLOPS)
      )
      (19): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.69 ms = 3.8% latency, 18.52 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.36 ms = 1.1% latency, 10.89 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 61.27 us = 0.05% latency, 105.14 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 61.04 us = 0.05% latency, 19.79 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 135.66 us = 0.11% latency, 249.28 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 63.42 us = 0.05% latency, 33.86 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 65.57 us = 0.05% latency, 65.51 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 34.81 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.95 ms = 2.39% latency, 24.04 TFLOPS
          (experts): ModuleList(
            (0-4): 5 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (5): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 295.4 us = 0.24% latency, 29.99 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 59.37 us = 0.05% latency, 49.74 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 46.73 us = 0.04% latency, 63.19 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.25 us = 0.03% latency, 71.59 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 46.01 us = 0.04% latency, 31.33 GFLOPS)
            )
            (6): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 237.23 us = 0.19% latency, 37.35 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 45.78 us = 0.04% latency, 64.5 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.9 us = 0.03% latency, 43.82 GFLOPS)
            )
            (7-22): 16 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (23): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 226.74 us = 0.18% latency, 39.08 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.05 us = 0.03% latency, 73.72 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.38 us = 0.03% latency, 43.2 GFLOPS)
            )
            (24-39): 16 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (40): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 236.51 us = 0.19% latency, 37.46 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 50.07 us = 0.04% latency, 58.98 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.23 us = 0.03% latency, 46.16 GFLOPS)
            )
            (41-43): 3 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (44): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 230.55 us = 0.19% latency, 38.43 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 42.2 us = 0.03% latency, 69.97 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.38 us = 0.03% latency, 43.2 GFLOPS)
            )
            (45-53): 9 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (54): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 225.31 us = 0.18% latency, 39.33 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.29 us = 0.03% latency, 73.28 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.24 us = 0.03% latency, 81.48 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.38 us = 0.03% latency, 43.2 GFLOPS)
            )
            (55-63): 9 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 147.1 us = 0.12% latency, 912.42 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 327.35 us = 0.27% latency, 54.14 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 76.29 us = 0.06% latency, 77.41 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 60.8 us = 0.05% latency, 97.14 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 52.45 us = 0.04% latency, 112.59 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 42.44 us = 0.03% latency, 67.95 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 141.62 us = 0.11% latency, 3.8 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 121.36 us = 0.1% latency, 4.43 TFLOPS)
      )
      (20): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.57 ms = 3.71% latency, 19.01 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.4 ms = 1.13% latency, 10.59 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 67.95 us = 0.06% latency, 94.81 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 59.84 us = 0.05% latency, 20.19 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 137.81 us = 0.11% latency, 245.4 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 67.23 us = 0.05% latency, 31.94 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 67.71 us = 0.05% latency, 63.43 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 33.14 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.81 ms = 2.28% latency, 25.3 TFLOPS
          (experts): ModuleList(
            (0): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (1): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 290.16 us = 0.24% latency, 30.54 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 64.85 us = 0.05% latency, 45.53 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.82 us = 0.04% latency, 65.88 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.05 us = 0.03% latency, 73.72 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 40.53 us = 0.03% latency, 35.57 GFLOPS)
            )
            (2-19): 18 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (20): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 239.13 us = 0.19% latency, 37.05 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 45.06 us = 0.04% latency, 65.53 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.05 us = 0.03% latency, 73.72 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 34.57 us = 0.03% latency, 41.71 GFLOPS)
            )
            (21-35): 15 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (36): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 224.83 us = 0.18% latency, 39.41 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.62 us = 0.03% latency, 76.45 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.95 us = 0.03% latency, 45.13 GFLOPS)
            )
            (37): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (38): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 227.69 us = 0.18% latency, 38.91 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.14 us = 0.03% latency, 43.51 GFLOPS)
            )
            (39-56): 18 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (57): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 229.84 us = 0.19% latency, 38.55 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 46.01 us = 0.04% latency, 64.17 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.23 us = 0.03% latency, 46.16 GFLOPS)
            )
            (58-59): 2 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (60): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 224.35 us = 0.18% latency, 39.49 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.58 us = 0.03% latency, 74.61 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.66 us = 0.03% latency, 44.14 GFLOPS)
            )
            (61-63): 3 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 145.91 us = 0.12% latency, 919.87 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 338.79 us = 0.27% latency, 52.31 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 77.25 us = 0.06% latency, 76.45 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 61.27 us = 0.05% latency, 96.38 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 60.08 us = 0.05% latency, 98.29 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 42.68 us = 0.03% latency, 67.57 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 125.89 us = 0.1% latency, 4.27 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 128.03 us = 0.1% latency, 4.2 TFLOPS)
      )
      (21): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.76 ms = 3.86% latency, 18.26 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.36 ms = 1.1% latency, 10.91 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 60.32 us = 0.05% latency, 106.8 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 60.32 us = 0.05% latency, 20.03 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 134.94 us = 0.11% latency, 250.6 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 62.94 us = 0.05% latency, 34.12 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 69.14 us = 0.06% latency, 62.12 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 32.9 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 3.04 ms = 2.46% latency, 23.37 TFLOPS
          (experts): ModuleList(
            (0-9): 10 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (10): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 288.72 us = 0.23% latency, 30.69 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 61.04 us = 0.05% latency, 48.38 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 43.39 us = 0.04% latency, 68.05 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 46.73 us = 0.04% latency, 63.19 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 39.34 us = 0.03% latency, 36.65 GFLOPS)
            )
            (11-14): 4 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (15): DeepseekV2MLP(
              8.65 M = 0.06% Params, 69.21 MMACs = 0.01% MACs, 237.46 us = 0.19% latency, 583.02 GFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 23.07 MMACs = 0% MACs, 44.82 us = 0.04% latency, 1.03 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 23.07 MMACs = 0% MACs, 39.1 us = 0.03% latency, 1.18 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 23.07 MMACs = 0% MACs, 37.67 us = 0.03% latency, 1.22 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 35.52 us = 0.03% latency, 634.16 MFLOPS)
            )
            (16): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.36 GMACs = 0.34% MACs, 239.85 us = 0.19% latency, 36.36 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.45 GMACs = 0.11% MACs, 39.1 us = 0.03% latency, 74.34 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.45 GMACs = 0.11% MACs, 48.16 us = 0.04% latency, 60.35 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.45 GMACs = 0.11% MACs, 42.2 us = 0.03% latency, 68.88 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.19 us = 0.03% latency, 44.09 GFLOPS)
            )
            (17-18): 2 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (19): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 219.58 us = 0.18% latency, 40.35 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.95 us = 0.03% latency, 79.9 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 35.76 us = 0.03% latency, 82.57 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.99 us = 0.03% latency, 46.52 GFLOPS)
            )
            (20): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (21): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 217.44 us = 0.18% latency, 40.75 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.24 us = 0.03% latency, 81.48 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.72 us = 0.03% latency, 80.42 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.99 us = 0.03% latency, 46.52 GFLOPS)
            )
            (22-53): 32 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (54): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 216.72 us = 0.18% latency, 40.88 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.72 us = 0.03% latency, 80.42 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.95 us = 0.03% latency, 79.9 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 35.76 us = 0.03% latency, 82.57 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.99 us = 0.03% latency, 46.52 GFLOPS)
            )
            (55): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (56): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 223.64 us = 0.18% latency, 39.62 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 35.76 us = 0.03% latency, 82.57 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.72 us = 0.03% latency, 80.42 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.28 us = 0.02% latency, 47.62 GFLOPS)
            )
            (57-63): 7 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 165.22 us = 0.13% latency, 812.36 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 333.79 us = 0.27% latency, 53.09 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 72.96 us = 0.06% latency, 80.95 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 62.7 us = 0.05% latency, 94.18 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 57.94 us = 0.05% latency, 101.93 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 42.44 us = 0.03% latency, 67.95 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 128.51 us = 0.1% latency, 4.19 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 120.64 us = 0.1% latency, 4.46 TFLOPS)
      )
      (22): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.56 ms = 3.7% latency, 19.05 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.35 ms = 1.09% latency, 10.97 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 62.94 us = 0.05% latency, 102.35 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 60.32 us = 0.05% latency, 20.03 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 136.14 us = 0.11% latency, 248.4 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 63.18 us = 0.05% latency, 33.99 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 65.57 us = 0.05% latency, 65.51 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 33.86 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.83 ms = 2.3% latency, 25.06 TFLOPS
          (experts): ModuleList(
            (0-2): 3 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (3): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 270.84 us = 0.22% latency, 32.71 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 58.89 us = 0.05% latency, 50.14 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 43.39 us = 0.04% latency, 68.05 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.05 us = 0.03% latency, 73.72 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 38.86 us = 0.03% latency, 37.1 GFLOPS)
            )
            (4): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (5): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 232.93 us = 0.19% latency, 38.04 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 45.78 us = 0.04% latency, 64.5 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.95 us = 0.03% latency, 45.13 GFLOPS)
            )
            (6): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 233.89 us = 0.19% latency, 37.88 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 42.44 us = 0.03% latency, 69.58 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.77 us = 0.03% latency, 72.43 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 34.09 us = 0.03% latency, 42.29 GFLOPS)
            )
            (7-10): 4 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (11): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 242.23 us = 0.2% latency, 36.58 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 43.15 us = 0.03% latency, 68.42 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.62 us = 0.03% latency, 76.45 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 36.48 us = 0.03% latency, 39.52 GFLOPS)
            )
            (12-54): 43 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (55): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 223.4 us = 0.18% latency, 39.66 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.95 us = 0.03% latency, 79.9 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.19 us = 0.03% latency, 44.79 GFLOPS)
            )
            (56-57): 2 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (58): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 224.35 us = 0.18% latency, 39.49 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.72 us = 0.03% latency, 80.42 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 35.05 us = 0.03% latency, 41.14 GFLOPS)
            )
            (59-63): 5 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 158.31 us = 0.13% latency, 847.84 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 323.77 us = 0.26% latency, 54.73 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 70.1 us = 0.06% latency, 84.25 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 60.08 us = 0.05% latency, 98.29 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 56.51 us = 0.05% latency, 104.51 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 41.72 us = 0.03% latency, 69.11 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 135.42 us = 0.11% latency, 3.97 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 122.31 us = 0.1% latency, 4.4 TFLOPS)
      )
      (23): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.66 ms = 3.77% latency, 18.67 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.35 ms = 1.1% latency, 10.95 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 61.27 us = 0.05% latency, 105.14 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 59.84 us = 0.05% latency, 20.19 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 142.34 us = 0.12% latency, 237.59 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 65.09 us = 0.05% latency, 32.99 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 75.58 us = 0.06% latency, 56.83 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 33.62 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.92 ms = 2.37% latency, 24.29 TFLOPS
          (experts): ModuleList(
            (0): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 284.67 us = 0.23% latency, 31.13 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 58.17 us = 0.05% latency, 50.76 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.58 us = 0.04% latency, 66.23 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 49.11 us = 0.04% latency, 60.12 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 42.92 us = 0.03% latency, 33.6 GFLOPS)
            )
            (1-2): 2 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (3): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 250.82 us = 0.2% latency, 35.33 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 52.21 us = 0.04% latency, 56.55 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 43.15 us = 0.03% latency, 68.42 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 35.52 us = 0.03% latency, 40.59 GFLOPS)
            )
            (4): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (5): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 222.21 us = 0.18% latency, 39.88 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.95 us = 0.03% latency, 79.9 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.42 us = 0.03% latency, 44.47 GFLOPS)
            )
            (6-7): 2 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (8): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 222.44 us = 0.18% latency, 39.83 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.23 us = 0.03% latency, 46.16 GFLOPS)
            )
            (9-44): 36 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (45): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 218.15 us = 0.18% latency, 40.62 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.95 us = 0.03% latency, 79.9 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.48 us = 0.03% latency, 80.95 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.71 us = 0.03% latency, 45.47 GFLOPS)
            )
            (46): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (47): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 236.03 us = 0.19% latency, 37.54 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 43.63 us = 0.04% latency, 67.68 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.82 us = 0.04% latency, 65.88 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.47 us = 0.03% latency, 45.81 GFLOPS)
            )
            (48-63): 16 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 150.68 us = 0.12% latency, 890.76 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 335.93 us = 0.27% latency, 52.75 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 76.29 us = 0.06% latency, 77.41 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 66.04 us = 0.05% latency, 89.42 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 53.41 us = 0.04% latency, 110.58 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 41.96 us = 0.03% latency, 68.72 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 136.38 us = 0.11% latency, 3.94 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 126.36 us = 0.1% latency, 4.26 TFLOPS)
      )
      (24): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.63 ms = 3.76% latency, 18.75 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.35 ms = 1.09% latency, 10.98 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 66.28 us = 0.05% latency, 97.2 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 59.6 us = 0.05% latency, 20.27 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 136.14 us = 0.11% latency, 248.4 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 63.66 us = 0.05% latency, 33.73 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 67.23 us = 0.05% latency, 63.88 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 33.86 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.93 ms = 2.37% latency, 24.24 TFLOPS
          (experts): ModuleList(
            (0-7): 8 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (8): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 297.07 us = 0.24% latency, 29.83 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 74.63 us = 0.06% latency, 39.57 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 47.21 us = 0.04% latency, 62.55 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.77 us = 0.03% latency, 72.43 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 44.11 us = 0.04% latency, 32.69 GFLOPS)
            )
            (9): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (10): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 231.74 us = 0.19% latency, 38.23 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.05 us = 0.03% latency, 73.72 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.05 us = 0.03% latency, 73.72 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.66 us = 0.03% latency, 44.14 GFLOPS)
            )
            (11-23): 13 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (24): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 237.23 us = 0.19% latency, 37.35 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 48.88 us = 0.04% latency, 60.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.99 us = 0.03% latency, 46.52 GFLOPS)
            )
            (25-46): 22 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (47): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 234.6 us = 0.19% latency, 37.77 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.35 us = 0.04% latency, 66.59 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.42 us = 0.03% latency, 44.47 GFLOPS)
            )
            (48-61): 14 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (62): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 228.64 us = 0.19% latency, 38.75 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.62 us = 0.03% latency, 76.45 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.05 us = 0.03% latency, 73.72 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.95 us = 0.03% latency, 79.9 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 36.48 us = 0.03% latency, 39.52 GFLOPS)
            )
            (63): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 216.48 us = 0.18% latency, 40.93 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.72 us = 0.03% latency, 80.42 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.04 us = 0.02% latency, 47.99 GFLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 166.89 us = 0.14% latency, 804.23 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 323.53 us = 0.26% latency, 54.77 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 76.29 us = 0.06% latency, 77.41 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 54.12 us = 0.04% latency, 109.12 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 56.98 us = 0.05% latency, 103.64 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 42.2 us = 0.03% latency, 68.33 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 123.5 us = 0.1% latency, 4.36 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 121.59 us = 0.1% latency, 4.42 TFLOPS)
      )
      (25): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.67 ms = 3.78% latency, 18.62 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.35 ms = 1.09% latency, 10.97 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 68.66 us = 0.06% latency, 93.82 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 60.8 us = 0.05% latency, 19.87 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 134.47 us = 0.11% latency, 251.49 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 67.47 us = 0.05% latency, 31.83 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 65.8 us = 0.05% latency, 65.27 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 34.33 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.94 ms = 2.38% latency, 24.18 TFLOPS
          (experts): ModuleList(
            (0): DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (1): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 288.72 us = 0.23% latency, 30.69 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 70.33 us = 0.06% latency, 41.98 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.58 us = 0.04% latency, 66.23 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.53 us = 0.03% latency, 72.85 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 39.58 us = 0.03% latency, 36.43 GFLOPS)
            )
            (2-10): 9 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (11): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 247.48 us = 0.2% latency, 35.8 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 48.64 us = 0.04% latency, 60.71 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.35 us = 0.04% latency, 66.59 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.77 us = 0.03% latency, 72.43 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 33.62 us = 0.03% latency, 42.89 GFLOPS)
            )
            (12-37): 26 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (38): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 226.26 us = 0.18% latency, 39.16 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.34 us = 0.03% latency, 75.06 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.15 us = 0.03% latency, 77.41 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.71 us = 0.03% latency, 45.47 GFLOPS)
            )
            (39): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 228.64 us = 0.19% latency, 38.75 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 44.35 us = 0.04% latency, 66.59 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 30.99 us = 0.03% latency, 46.52 GFLOPS)
            )
            (40-44): 5 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (45): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 228.17 us = 0.18% latency, 38.83 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 42.44 us = 0.03% latency, 69.58 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.9 us = 0.03% latency, 43.82 GFLOPS)
            )
            (46-60): 15 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (61): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 223.64 us = 0.18% latency, 39.62 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.1 us = 0.03% latency, 75.52 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.67 us = 0.03% latency, 78.39 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.19 us = 0.03% latency, 79.39 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.95 us = 0.03% latency, 45.13 GFLOPS)
            )
            (62-63): 2 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 146.15 us = 0.12% latency, 918.37 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 332.12 us = 0.27% latency, 53.36 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 77.72 us = 0.06% latency, 75.98 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 60.32 us = 0.05% latency, 97.9 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 56.74 us = 0.05% latency, 104.07 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 41.72 us = 0.03% latency, 69.11 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 138.04 us = 0.11% latency, 3.9 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 127.79 us = 0.1% latency, 4.21 TFLOPS)
      )
      (26): DeepseekV2DecoderLayer(
        584.85 M = 3.72% Params, 42.88 GMACs = 3.39% MACs, 4.58 ms = 3.71% latency, 18.97 TFLOPS
        (self_attn): DeepseekV2Attention(
          13.76 M = 0.09% Params, 7.38 GMACs = 0.58% MACs, 1.38 ms = 1.12% latency, 10.75 TFLOPS
          (q_proj): Linear(6.29 M = 0.04% Params, 3.22 GMACs = 0.25% MACs, 65.33 us = 0.05% latency, 98.62 TFLOPS, in_features=2048, out_features=3072, bias=False)
          (kv_a_proj_with_mqa): Linear(1.18 M = 0.01% Params, 603.98 MMACs = 0.05% MACs, 60.56 us = 0.05% latency, 19.95 TFLOPS, in_features=2048, out_features=576, bias=False)
          (kv_a_layernorm): DeepseekV2RMSNorm(512 = 0% Params, 0 MACs = 0% MACs, 144 us = 0.12% latency, 234.83 GFLOPS)
          (kv_b_proj): Linear(2.1 M = 0.01% Params, 1.07 GMACs = 0.08% MACs, 66.04 us = 0.05% latency, 32.52 TFLOPS, in_features=512, out_features=4096, bias=False)
          (o_proj): Linear(4.19 M = 0.03% Params, 2.15 GMACs = 0.17% MACs, 85.35 us = 0.07% latency, 50.32 TFLOPS, in_features=2048, out_features=2048, bias=False)
          (rotary_emb): DeepseekV2YarnRotaryEmbedding(0 = 0% Params, 0 MACs = 0% MACs, 38.62 us = 0.03% latency, 0 FLOPS)
        )
        (mlp): DeepseekV2MoE(
          571.08 M = 3.64% Params, 35.5 GMACs = 2.81% MACs, 2.85 ms = 2.31% latency, 24.95 TFLOPS
          (experts): ModuleList(
            (0-5): 6 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (6): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 267.03 us = 0.22% latency, 33.18 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 58.41 us = 0.05% latency, 50.55 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 42.44 us = 0.03% latency, 69.58 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.58 us = 0.03% latency, 74.61 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 37.91 us = 0.03% latency, 38.03 GFLOPS)
            )
            (7-13): 7 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (14): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 250.82 us = 0.2% latency, 35.33 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 39.82 us = 0.03% latency, 74.16 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.48 us = 0.03% latency, 71.18 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 41.01 us = 0.03% latency, 72.01 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 34.33 us = 0.03% latency, 42 GFLOPS)
            )
            (15): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 224.59 us = 0.18% latency, 39.45 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.91 us = 0.03% latency, 77.89 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.19 us = 0.03% latency, 44.79 GFLOPS)
            )
            (16-30): 15 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (31): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 238.66 us = 0.19% latency, 37.13 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 42.68 us = 0.03% latency, 69.19 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 40.29 us = 0.03% latency, 73.28 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 43.15 us = 0.03% latency, 68.42 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.9 us = 0.03% latency, 43.82 GFLOPS)
            )
            (32-48): 17 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (49): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 225.07 us = 0.18% latency, 39.37 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.39 us = 0.03% latency, 76.92 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.86 us = 0.03% latency, 75.98 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 37.43 us = 0.03% latency, 78.88 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 32.19 us = 0.03% latency, 44.79 GFLOPS)
            )
            (50-56): 7 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
            (57): DeepseekV2MLP(
              8.65 M = 0.06% Params, 4.43 GMACs = 0.35% MACs, 238.9 us = 0.19% latency, 37.09 TFLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 54.6 us = 0.04% latency, 54.08 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 38.62 us = 0.03% latency, 76.45 TFLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 1.48 GMACs = 0.12% MACs, 36.72 us = 0.03% latency, 80.42 TFLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 31.47 us = 0.03% latency, 45.81 GFLOPS)
            )
            (58-63): 6 x DeepseekV2MLP(
              8.65 M = 0.06% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS
              (gate_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (up_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=2048, out_features=1408, bias=False)
              (down_proj): Linear(2.88 M = 0.02% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS, in_features=1408, out_features=2048, bias=False)
              (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 0 s = 0% latency, 0 FLOPS)
            )
          )
          (gate): MoEGate(131.07 K = 0% Params, 67.11 MMACs = 0.01% MACs, 150.68 us = 0.12% latency, 890.76 GFLOPS)
          (shared_experts): DeepseekV2MLP(
            17.3 M = 0.11% Params, 8.86 GMACs = 0.7% MACs, 335.93 us = 0.27% latency, 52.75 TFLOPS
            (gate_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 76.53 us = 0.06% latency, 77.16 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (up_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 58.17 us = 0.05% latency, 101.52 TFLOPS, in_features=2048, out_features=2816, bias=False)
            (down_proj): Linear(5.77 M = 0.04% Params, 2.95 GMACs = 0.23% MACs, 55.55 us = 0.05% latency, 106.31 TFLOPS, in_features=2816, out_features=2048, bias=False)
            (act_fn): SiLUActivation(0 = 0% Params, 0 MACs = 0% MACs, 43.39 us = 0.04% latency, 66.45 GFLOPS)
          )
        )
        (input_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 123.74 us = 0.1% latency, 4.35 TFLOPS)
        (post_attention_layernorm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 121.83 us = 0.1% latency, 4.42 TFLOPS)
      )
    )
    (norm): DeepseekV2RMSNorm(2.05 K = 0% Params, 0 MACs = 0% MACs, 122.79 us = 0.1% latency, 4.38 TFLOPS)
  )
  (lm_head): Linear(209.72 M = 1.34% Params, 107.37 GMACs = 8.49% MACs, 581.74 us = 0.47% latency, 369.15 TFLOPS, in_features=2048, out_features=102400, bias=False)
)
------------------------------------------------------------------------------
FLOPs: 2.56 T MACs: 1.26 TMACs Params: 15.71 B
